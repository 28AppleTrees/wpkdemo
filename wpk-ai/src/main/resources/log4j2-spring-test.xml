<?xml version="1.0" encoding="UTF-8"?>
<!--配置详解:https://zhuanlan.zhihu.com/p/701595014 -->
<!--日志级别以及优先级排序: OFF > FATAL > ERROR > WARN > INFO > DEBUG > TRACE > ALL -->
<!--Configuration后面的status，这个用于设置log4j2自身内部的信息输出，可以不设置，当设置成trace时，你会看到log4j2内部各种详细输出-->
<!--monitorInterval: Log4j能够自动检测修改配置 文件和重新配置本身，设置间隔秒数, 需要注意在开发时项目启动后改的是target下配置 -->
<configuration status="WARN" monitorInterval="30">

    <!-- 变量的定义必须在Properties标签下 -->
    <Properties>
<!--        <springProperty scope="context" name="APP_NAME" source="spring.application.name" defaultValue="application"/>-->
        <Property name="APP_NAME" value="wpk-ai"/>
        <!--定义日志文件的存储地址 -->
        <!-- 注意win开发时, 如使用相对目录前必须要有`.`, 不然找不到输出目录 -->
        <property name="LOG_HOME" value="./logs" />

        <!-- PatternLayout   使用模式字符串配置的灵活布局
            charset     编码方式
            pattern     指定日志输出的具体格式
             %c{x}   Logger的名称,x 为精度说明符-->
        <!--            <PatternLayout pattern="%d{yyyy-MM-dd HH:mm:ss.SSS} [%thread] %-5level [%logger{50}:%L] - %msg%n"/>-->
        <!-- 格式化输出：%date 表示日期，%thread(%t) 表示线程名，%-5level：级别从左显示 5 个字符宽度 %msg：日志消息，
        %n 是换行符 %class 完整类名 %l 位置信息包括类名、方法名、文件名和行号-->
        <!-- %logger{36} 表示 Logger 名字最长 36 个字符 -->
        <property name="LOG_PATTERN" value="%d{yyyy-MM-dd HH:mm:ss.SSS} [%15thread] %-5level [%logger{50}:%L] - %msg%n"/>
    </Properties>

    <!--先定义所有的appender-->
    <appenders>
        <!--这个输出控制台的配置-->
        <console name="Console" target="SYSTEM_OUT">
            <!--输出日志的格式-->
            <PatternLayout pattern="${LOG_PATTERN}"/>
        </console>
        <!--文件会打印出所有信息，这个log每次运行程序会自动清空，由append属性决定，适合临时测试用-->
        <File name="tempLog" fileName="${LOG_HOME}/${APP_NAME}_temp.log" append="false">
            <!-- %xEx 异常时输出完整的异常信息，包括异常类名、消息、堆栈跟踪等详细信息 -->
            <PatternLayout pattern="%d{HH:mm:ss.SSS} [%15thread] %-5level %c{36} %l %M - %msg%xEx%n"/>
        </File>

        <!-- 这个会打印出所有的info及以下级别的信息，每次大小超过size，则这size大小的日志会自动存入按年份-月份建立的文件夹下面并进行压缩，作为存档-->
        <RollingFile name="RollingFileInfo" fileName="${LOG_HOME}/${APP_NAME}_info_${date:yyyy-MM-dd}.log"
                     filePattern="${LOG_HOME}/${APP_NAME}_info-%d{yyyy-MM-dd}_%i.log.gz" append="true">
            <!--控制台只输出level及以上级别的信息（onMatch），其他的直接拒绝（onMismatch）-->
            <ThresholdFilter level="info" onMatch="ACCEPT" onMismatch="DENY"/>
            <PatternLayout pattern="${LOG_PATTERN}"/>
            <Policies>
                <TimeBasedTriggeringPolicy/>
                <SizeBasedTriggeringPolicy size="100MB"/>
            </Policies>
            <!-- DefaultRolloverStrategy属性如不设置，则默认为最多同一文件夹下7个文件-->
            <DefaultRolloverStrategy max="100"/>
        </RollingFile>
        <RollingFile name="RollingFileWarn" fileName="${LOG_HOME}/${APP_NAME}_warn_${date:yyyy-MM-dd}.log"
                     filePattern="${LOG_HOME}/${APP_NAME}_warn-%d{yyyy-MM-dd}_%i.log.gz" append="true">
            <ThresholdFilter level="warn" onMatch="ACCEPT" onMismatch="DENY"/>
            <PatternLayout pattern="${LOG_PATTERN}"/>
            <Policies>
                <TimeBasedTriggeringPolicy/>
                <SizeBasedTriggeringPolicy size="100MB"/>
            </Policies>
            <DefaultRolloverStrategy max="100"/>
        </RollingFile>
        <RollingFile name="RollingFileError" fileName="${LOG_HOME}/${APP_NAME}_error_${date:yyyy-MM-dd}.log"
                     filePattern="${LOG_HOME}/${APP_NAME}_error-%d{yyyy-MM-dd}_%i.log.gz" append="true">
            <ThresholdFilter level="error" onMatch="ACCEPT" onMismatch="DENY"/>
            <PatternLayout pattern="${LOG_PATTERN}"/>
            <Policies>
                <TimeBasedTriggeringPolicy/>
                <SizeBasedTriggeringPolicy size="100MB"/>
            </Policies>
            <DefaultRolloverStrategy max="100"/>>
        </RollingFile>
    </appenders>
    <!--然后定义logger，只有定义了logger并引入的appender，appender才会生效-->
    <loggers>
        <!--过滤掉spring和mybatis的一些无用的DEBUG信息-->
<!--        <logger name="org.springframework" level="INFO"></logger>-->
<!--        <logger name="org.mybatis" level="INFO"></logger>-->
        <root level="DEBUG">
            <appender-ref ref="tempLog"/>
            <appender-ref ref="Console"/>
            <appender-ref ref="RollingFileInfo"/>
<!--            <appender-ref ref="RollingFileWarn"/>-->
<!--            <appender-ref ref="RollingFileError"/>-->
        </root>
    </loggers>
</configuration>